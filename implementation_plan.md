# ESEI Student Portal - Implementation Plan

## Technology Stack Architecture

*   **Frontend**: React (Next.js framework)
    *   *Why*: Best-in-class integration with Vercel, supports Server Side Rendering (SSR) for performance, and easy API route creation.
    *   *Styling*: Tailwind CSS (Glassmorphism design system).
*   **Hosting**: Vercel
    *   Hosts both the frontend assets and the serverless API function layer.
*   **Database**: Airtable
    *   Acts as the Headless CMS and Relational Database.
    *   Stores: Student profiles, authentication details, course content, grades, and submission logs.
*   **Automation & Middleware API**: n8n
    *   Acts as the primary "Logic Layer" and orchestration engine.
    *   The Frontend (Vercel) will send requests to n8n Webhooks.
    *   n8n handles business logic, connects to Airtable, runs AI grading agents, and returns responses.
*   **Backend Code**: Generated by Claude Code
    *   Vercel Serverless Functions acting as a secure proxy between the Frontend and n8n/Airtable to protect API keys and handle session management.

---

## Data Architecture (Airtable Schema)

We will need the following Tables in an Airtable Base:

1.  **Students**
    *   `student_id` (Primary Key)
    *   `email` (Login ID)
    *   `password_hash` (Secure storage)
    *   `full_name`
    *   `enrolled_courses` (Link to Courses)
    *   `avatar_url`

2.  **Courses**
    *   `course_id` (Primary Key)
    *   `course_name`
    *   `course_code` (e.g., OM-DM1)
    *   `term`
    *   `syllabus_url`

3.  **Assignments**
    *   `assignment_id`
    *   `course_id` (Link)
    *   `title`
    *   `description`
    *   `due_date`
    *   `max_score`

4.  **Submissions**
    *   `submission_id`
    *   `student_id` (Link)
    *   `assignment_id` (Link)
    *   `file_url`
    *   `ai_grading_feedback` (Long Text)
    *   `grade_obtained`
    *   `status` (Pending, Graded)

---

## API & Automation Strategy (n8n Workflows)

We will implement the following n8n workflows exposed as Webhooks:

1.  **Auth Workflow** (`POST /webhook/auth/login`)
    *   Input: Email, Password
    *   Action: Lookup Student in Airtable -> Verify Password -> Return Token/User Data.
2.  **Dashboard Data Aggregator** (`GET /webhook/student/dashboard`)
    *   Input: Student ID
    *   Action: Fetch Student details + Enrolled Courses + Recent Grades from Airtable -> Aggregate values -> Return JSON.
3.  **Submission Handler** (`POST /webhook/assignment/submit`)
    *   Input: Student ID, File, Assignment ID
    *   Action: Upload file to storage -> Create Submission Record in Airtable -> Trigger AI Grading Agent -> Update Record -> Return Success.

---

## Implementation Phases

### Phase 1: Project Initialization & Migration
1.  Initialize a **Next.js** project.
2.  Port the existing HTML/CSS design into reusable React Components (`LoginOverlay`, `Dashboard`, `CourseCard`).
3.  Configure Tailwind CSS in the Next.js environment.
4.  Deploy initial "Static" version to Vercel.

### Phase 2: Airtable & n8n Setup
1.  Set up the Airtable Base with the schema defined above.
2.  Set up a self-hosted or cloud n8n instance.
3.  Create the **Auth Workflow** in n8n.
4.  Create the **Dashboard Data** workflow in n8n.

### Phase 3: Backend Integration (Vercel -> n8n)
1.  Create Vercel Serverless Functions (API Routes) in Next.js:
    *   `/api/login` -> Proxies to n8n Auth Webhook.
    *   `/api/dashboard` -> Proxies to n8n Dashboard Webhook.
2.  Implement `fetch` calls in the React Frontend to consume these APIs.
3.  Replace hardcoded data in the UI with dynamic data from the API.

### Phase 4: AI Tutor & Submission Features
1.  Implement the File Upload logic (sending files to n8n).
2.  Build the "AI Grading" workflow in n8n (using LLM nodes).
3.  (Optional) Integrate the ElevenLabs widget for the Voice Tutor.

---

## Next Immediate Steps
1.  **Scaffold Next.js App**: Create the actual folder structure.
2.  **Component Migration**: Move the current static HTML into React components.
